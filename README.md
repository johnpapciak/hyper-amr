# Multimodal Hyperbolic AMR

### Hyperbolic multimodal representation learning for hierarchical detection of antimicrobial-resistance (AMR) genes and microbial taxa in metagenomic data.

---

## Overview
This project explores **Hyperbolic Multimodal Representation Learning (HMRL)** for the detection and characterization of antimicrobial-resistance (AMR) genes from metagenomic sequencing data.
By embedding **DNA sequence features**, **AMR gene annotations**, and **taxonomic hierarchies** into a shared **hyperbolic space**, the model aims to preserve biological hierarchy and improve generalization across microbial lineages.

This approach combines deep sequence encoders with hyperbolic geometry to enable probabilistic inference of AMR potential, particularly for novel or under-annotated species.

---

## Project Motivation
Traditional machine learning models treat taxonomic labels as flat, independent categories, ignoring their hierarchical structure. However, microbial taxonomy expands exponentially from phylum to strain.
**Hyperbolic space**, with its exponential geometry, provides a natural representation for such biological trees.

By learning a **shared hyperbolic embedding** of sequence, function, and taxonomy, we can:
- Capture **hierarchical relationships** among taxa and AMR gene families.
- Infer **AMR potential** for uncharacterized or novel organisms.
- Enable **joint prediction** of host taxon and associated AMR genes.

---

## Methods

### Inputs
1. **Sequence embeddings** — contig-level representations (1–10 kb) generated by CNN or k-mer Transformer encoders.
2. **AMR gene features** — multi-hot or coverage-based vectors derived from curated databases (CARD, ResFinder).
3. **Taxonomic embeddings** — hierarchical node vectors representing species, genus, and family relationships.

### Model
- Projects all three modalities into a shared **Poincaré-ball hyperbolic manifold**.
- Optimizes three loss components:
  - **Alignment loss (contrastive/InfoNCE):** pulls true sequence–AMR–taxon triplets together.
  - **Stacked entailment loss:** enforces hierarchical structure among taxonomic ancestors.
  - **Optional supervised loss:** for AMR presence classification.

### Outputs
- Predicted **taxonomic identity** of contigs.
- Predicted **probability of AMR gene presence**.

---

## Data
- **AMR Databases:** CARD, ResFinder
- **Taxonomy Source:** NCBI RefSeq genomes
- **Benchmarking:** CAMI metagenomic datasets
- ~100,000 contigs (≈30k AMR-positive, 70k negatives)
- Stratified 70/15/15 splits with genus/species-exclusive partitions for hierarchical generalization testing.

---

## Evaluation
Performance will be compared against:
- **Taxonomy tools:** Kraken2, Bracken
- **AMR tools:** AMRFinder Plus, ResFinder
- **Model ablations:** Euclidean multimodal and unimodal (sequence-only) baselines

### Metrics
- **AUPR / AUROC:** for AMR detection
- **Hierarchical accuracy:** for taxonomic prediction
- **Joint AMR–Taxon F1:** for functional–evolutionary consistency
- **Open-set and low-abundance tests:** for robustness

Uncertainty may be estimated using bootstrap resampling over test contigs.